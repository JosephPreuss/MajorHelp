<!DOCTYPE html>
<html lang="en">
{% include "navbar.html" %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Page</title>
    
    <script>
        const departmentOptions = [
            'Humanities and Social Sciences',
            'Natural Sciences and Mathematics',
            'Business and Economics',
            'Education',
            'Engineering and Technology',
            'Health Sciences',
            'Arts and Design',
            'Agriculture and Environmental Studies',
            'Communication and Media',
            'Law and Criminal Justice'
        ];

        function setActiveFilter(filter) {
            document.getElementById("filter").value = filter;

            const buttons = document.querySelectorAll(".filter-buttons button");
            buttons.forEach(button => button.classList.remove("active"));
            document.getElementById(filter + "-button").classList.add("active");

            const searchFieldContainer = document.getElementById("search-field-container");

            if (filter === 'department') {
                const select = document.createElement("select");
                select.name = "query";
                select.id = "search-query";

                // Add "Pick a Department" as the default greyed-out option
                select.innerHTML = `<option value="" disabled selected>Pick a Department</option>` +
                    departmentOptions.map(option => `<option value="${option}">${option}</option>`).join('');

                searchFieldContainer.innerHTML = ''; 
                searchFieldContainer.appendChild(select);
            } else {
                const input = document.createElement("input");
                input.type = "text";
                input.id = "search-query";
                input.name = "query";
                input.placeholder = `Enter ${filter} name...`;
                searchFieldContainer.innerHTML = ''; 
                searchFieldContainer.appendChild(input);
            }
        }

        window.onload = function () {
            const filter = "{{ filter_type }}";
            setActiveFilter(filter);
        };
    </script>
</head>
<body>

<div class="search-container">
    <h2>Search</h2>
    <form action="/search/" method="get">
        <div id="search-field-container">
            <input type="text" id="search-query" name="query" placeholder="Enter your search term..." value="{{ query }}">
        </div>
        
        <div class="filter-buttons">
            <button type="button" id="department-button" onclick="setActiveFilter('department')">Department</button>
            <button type="button" id="school-button" onclick="setActiveFilter('school')">School</button>
            <button type="button" id="major-button" onclick="setActiveFilter('major')">Major</button>
        </div>

        <input type="hidden" id="filter" name="filter" value="department">
        
        <button type="submit">Search</button>
    </form>
</div>

</body>
</html>