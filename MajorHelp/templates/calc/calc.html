<!-- templates/calc/calc.html -->
{% extends 'MajorHelp/HomePage.html' %}

{% load static %}

{% block title %}Tuition Calc{% endblock %}

{% block stylesheet %}{% static 'css/calc.css' %}{% endblock stylesheet %}

{% block script %}
<script>
    var inputData = {
        uni   : null,
        dept  : null,
        major : null,
    }

    async function validateInputData() {
        for (const [ignored, value] of Object.entries(inputData)) {
            if (value == null) return;
        }
        // None of the data values are null, the request is ready.

        // Prepare the GET request string for the url
        var getStr = "?";

        for (const [key, value] of Object.entries(inputData)) {
            getStr = getStr.concat(key.toString() + "=" + value.toString() + "&");
        }
         
        // Make a fetch request, the url can just be the get data
        // Django will automatically prepend /calc/ to it.

        const response = await fetch(getStr,  { 
            method : 'GET',
            headers: {"Content-Type": "application/json",},
        });

        if (!response.ok) {
            throw new Error(`Response status: ${response.status}`);
        }

        const json = await response.json();
        
        console.log(json);
    }

    function Input(entry) {

        // check if the entered data isn't just whitespace via trim and length
        data = document.getElementById(entry).value.trim();
        if (data.length == 0) return;

        inputData[entry] = data;
        validateInputData();
    }

</script>
{% endblock script %}


{% block content %}
<!-- get the original content from the home page-->
{{ block.super }} 
<div>
    <h1>Tuition Calculator</h1>
    <p>Let's start by choosing your school.</p>
</div>

<div id="uniInput">
    <!--The "; return false" prevents the form from actually submitting via post or get
        thus refreshing the page... which clears the form.-->
    <form onsubmit="Input('uni'); return false">
        <input type="text" id="uni" name="university" placeholder="Enter your university."
            value="">
    </form>

</div>

<br>

<div id="inputOutput">
    <div id="input">
        <div id="department">
            <h2>Now select the department</h2>
                <select id="dept" name="department" onchange="Input('dept')">
                    <option value="" disabled="" selected="">Pick a Department</option>
                    <option value="Humanities and Social Sciences">Humanities and Social Sciences</option>
                    <option value="Natural Sciences and Mathematics">Natural Sciences and Mathematics</option>
                    <option value="Business and Economics">Business and Economics</option>
                    <option value="Education">Education</option>
                    <option value="Engineering and Technology">Engineering and Technology</option>
                    <option value="Health Sciences">Health Sciences</option>
                    <option value="Arts and Design">Arts and Design</option>
                    <option value="Agriculture and Environmental Studies">Agriculture and Environmental Studies</option>
                    <option value="Communication and Media">Communication and Media</option>
                    <option value="Law and Criminal Justice">Law and Criminal Justice</option>
                </select>       
        </div>

        <div id="majors">
            <h2>Great, now lets talk majors.</h2>
            <form onsubmit="Input('major'); return false">
                <input type="text" name="major" id="major" placeholder="" value="">
            </form> 
        </div>
        <!--
        <div id="minors">
            <h2>Are you interested in enrolling in any minors?</h2>
            (placeholder text)
        </div>

        <div id="scholarships">
            <h2>Do you have any scholarships?</h2>
            (placeholder text)
        </div>

        <div id="extraAid">
            <h2>Enter any other estimated external aids</h2>
            (placeholder text)
        </div>
        -->
    </div>

    <div id="output">
        <h2>Estimated Total</h2>
        <h1>{{ total | default:"$XX,XXX - $XXX,XXX"}}</h1>
        
        <h2>Details:</h2>

        <!--
            A for loop could be placed through here to iterate through university, major, scholarship, etc
            and thier costs, credits, notes, etc
        -->

        <h3>University Related Costs</h3>
        <!--The name of the University/Major/Scholarship can go here-->
        University of South Carolina 
        <ul class="outputList">
            <!--
                For future reference, this can probably be replaced with a for loop containing all applicable
                items (meaning the left side will be replaced with a variable and presumably the right side 
                would be something like variableName.amount)
            -->
            <li>
                Base Tuition <span>{{ baseTuition | default:"$X,XXX" }}</span>
            </li>
            <li>
                Fees <span>{{ baseTuition | default:"$X,XXX" }}</span>
            </li>
            <li>
                Housing <span>{{ baseTuition | default:"$X,XXX" }}</span>
            </li>
            
            <br>

            <!--
                Notes section
                Can be surrounded by a for to include any notes
            -->
            <small>
                <li class="outputNote">
                    Alumni have reported that this university requires students to live on campus housing for freshman year.
                </li>
            </small>

            
        </ul>
 
        <h4>Subtotal</h4>
        <h4 style="margin-left:2.5em">$X,XXX - $XX,XXX</h4>





        <h3>Major Related Costs</h3>
        Computer Science
        <ul class="outputList">
            <li>
                Base Tuition <span>{{ baseTuition | default:"$X,XXX" }}</span>
            </li>
            <li>
                Fees <span>{{ baseTuition | default:"$X,XXX" }}</span>
            </li>

            <!--
                Notes section
                Can be surrounded by a for to include any notes
            -->
            <small>
                <li class="outputNote">
                    Alumini have reported that this university has a hidden lab fee specific to this Major.
                </li>
            </small>
            


        </ul>


        
        <h4>Subtotal</h4>
        <h4 style="margin-left:2.5em">$X,XXX - $XX,XXX


        <!-- Just repeat the estimated total again for readability-->
        <h2>Estimated Total</h2>
        <h1>{{ total | default:"$XX,XXX - $XXX,XXX"}}</h1>
    </div>
</div>
{% endblock content %}